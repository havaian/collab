@import 'tailwindcss/base';
@import 'tailwindcss/components';
@import 'tailwindcss/utilities';

/* Custom fonts */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap');

/* Base styles */
@layer base {
  html {
    @apply antialiased;
    font-feature-settings: 'cv02', 'cv03', 'cv04', 'cv11';
  }

  body {
    @apply bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100;
    font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }

  /* Scrollbar styles */
  * {
    @apply scrollbar-webkit;
  }

  /* Dark mode scrollbar */
  .dark * {
    scrollbar-color: theme('colors.gray.600') theme('colors.gray.800');
  }

  .dark *::-webkit-scrollbar-track {
    @apply bg-gray-800;
  }

  .dark *::-webkit-scrollbar-thumb {
    @apply bg-gray-600;
  }

  .dark *::-webkit-scrollbar-thumb:hover {
    @apply bg-gray-500;
  }

  /* Focus styles */
  *:focus {
    @apply outline-none;
  }

  /* Selection styles */
  ::selection {
    @apply bg-primary-200 text-primary-900;
  }

  .dark ::selection {
    @apply bg-primary-800 text-primary-100;
  }
}

/* Component layer */
@layer components {
  /* Monaco Editor dark theme override */
  .monaco-editor-dark {
    --vscode-editor-background: theme('colors.gray.900') !important;
    --vscode-editor-foreground: theme('colors.gray.100') !important;
  }

  /* Code execution terminal styles */
  .terminal-output {
    @apply font-mono text-sm bg-gray-900 text-green-400 p-4 rounded-lg;
    white-space: pre-wrap;
    word-break: break-word;
  }

  .terminal-output .error {
    @apply text-red-400;
  }

  .terminal-output .warning {
    @apply text-yellow-400;
  }

  .terminal-output .info {
    @apply text-blue-400;
  }

  /* Chat message styles */
  .chat-message {
    @apply max-w-none;
  }

  .chat-message p {
    @apply mb-2 last:mb-0;
  }

  .chat-message pre {
    @apply bg-gray-100 dark:bg-gray-800 p-3 rounded-md overflow-x-auto text-sm;
  }

  .chat-message code {
    @apply bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded text-sm font-mono;
  }

  .chat-message pre code {
    @apply bg-transparent p-0;
  }

  /* File tree styles */
  .file-tree {
    @apply select-none;
  }

  .file-tree-item {
    @apply flex items-center py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer;
  }

  .file-tree-item.selected {
    @apply bg-primary-50 dark:bg-primary-900/20 text-primary-700 dark:text-primary-300;
  }

  .file-tree-item .icon {
    @apply mr-2 flex-shrink-0;
  }

  /* Loading animations */
  .loading-spinner {
    @apply animate-spin rounded-full border-2 border-gray-300 border-t-primary-600;
  }

  .loading-dots {
    @apply flex space-x-1;
  }

  .loading-dots > div {
    @apply w-2 h-2 bg-gray-400 rounded-full animate-bounce;
  }

  .loading-dots > div:nth-child(2) {
    animation-delay: 0.1s;
  }

  .loading-dots > div:nth-child(3) {
    animation-delay: 0.2s;
  }

  /* Floating action button */
  .fab {
    @apply fixed bottom-6 right-6 w-14 h-14 bg-primary-600 text-white rounded-full shadow-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all duration-200 z-50;
  }

  .fab:hover {
    @apply scale-110 shadow-xl;
  }

  /* Notification styles */
  .notification {
    @apply fixed top-4 right-4 max-w-sm w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 z-50;
  }

  .notification-enter-active,
  .notification-leave-active {
    @apply transition-all duration-300;
  }

  .notification-enter-from {
    @apply transform translate-x-full opacity-0;
  }

  .notification-leave-to {
    @apply transform translate-x-full opacity-0;
  }

  /* Modal backdrop */
  .modal-backdrop {
    @apply fixed inset-0 bg-gray-500 bg-opacity-50 transition-opacity z-40;
  }

  .modal-backdrop.entering {
    @apply opacity-0;
  }

  .modal-backdrop.entered {
    @apply opacity-100;
  }

  /* Collaborative cursor styles */
  .collaborative-cursor {
    @apply absolute w-0.5 h-5 pointer-events-none z-10;
    animation: blink 1s infinite;
  }

  @keyframes blink {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0; }
  }

  .collaborative-cursor-label {
    @apply absolute -top-6 -left-1 px-2 py-1 text-xs text-white rounded shadow-lg whitespace-nowrap pointer-events-none;
  }

  /* Custom tooltip */
  .tooltip {
    @apply invisible absolute z-50;
  }

  .tooltip-content {
    @apply px-2 py-1 text-xs text-white bg-gray-900 rounded shadow-lg;
  }

  .has-tooltip:hover .tooltip {
    @apply visible;
  }
}

/* Utility layer */
@layer utilities {
  /* Text truncation variants */
  .truncate-2-lines {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .truncate-3-lines {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Gradient text */
  .text-gradient {
    @apply bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent;
  }

  /* Glass morphism effect */
  .glass {
    backdrop-filter: blur(16px) saturate(180%);
    background-color: rgba(255, 255, 255, 0.75);
    border: 1px solid rgba(209, 213, 219, 0.3);
  }

  .dark .glass {
    background-color: rgba(17, 24, 39, 0.75);
    border: 1px solid rgba(75, 85, 99, 0.3);
  }

  /* Safe area handling for mobile */
  .safe-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-left {
    padding-left: env(safe-area-inset-left);
  }

  .safe-right {
    padding-right: env(safe-area-inset-right);
  }
}

/* Monaco Editor specific styles */
.monaco-editor {
  --vscode-font-family: 'JetBrains Mono', 'Fira Code', Monaco, Consolas, monospace;
}

/* Override Monaco's scrollbar in dark mode */
.monaco-editor .scrollbar .slider {
  background: rgba(79, 70, 229, 0.4) !important;
}

.monaco-editor .scrollbar .slider:hover {
  background: rgba(79, 70, 229, 0.6) !important;
}